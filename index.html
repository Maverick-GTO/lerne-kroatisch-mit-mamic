<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Lerne Kroatisch mit Mamic</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#00529B">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="apple-touch-icon" href="logo.png">

    <style>
        :root {
            --dinamo-blue: #00529B;
            --neon-blue: #00f2ff;
            --white: #FFFFFF;
            --success: #28a745;
            --error: #dc3545;
            --black: #050505;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--dinamo-blue);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        /* Splash Screen */
        #splash-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--black);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 3000;
            transition: opacity 0.5s ease;
        }

        .neon-wrapper {
            position: relative;
            width: 280px; height: 280px;
            display: flex; justify-content: center; align-items: center;
        }

        .neon-line {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            border: 4px solid var(--neon-blue);
            border-radius: 20px;
            filter: drop-shadow(0 0 10px var(--neon-blue));
            animation: snake 3s linear infinite;
        }

        @keyframes snake {
            0%, 100% { clip-path: inset(0 0 97% 0); }
            25% { clip-path: inset(0 0 0 97%); }
            50% { clip-path: inset(97% 0 0 0); }
            75% { clip-path: inset(0 97% 0 0); }
        }

        #splash-img { width: 90%; height: 90%; object-fit: contain; z-index: 10; }

        /* Container */
        .container {
            width: 90%; max-width: 500px;
            background: var(--white);
            border-radius: 25px; padding: 25px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.4);
            text-align: center; display: none;
            box-sizing: border-box; color: #333;
        }

        .timer-box { font-size: 1.3rem; font-weight: bold; color: var(--dinamo-blue); margin-bottom: 10px; }
        .question-box { font-size: 1.4rem; font-weight: bold; margin: 20px 0; min-height: 80px; display: flex; align-items: center; justify-content: center; }

        .option {
            display: block; width: 100%; padding: 16px; margin: 10px 0;
            border: 2px solid var(--dinamo-blue); border-radius: 12px;
            background: var(--white); font-size: 1rem; font-weight: 600; cursor: pointer;
        }

        .correct { background: var(--success) !important; color: white; border-color: var(--success); }
        .wrong { background: var(--error) !important; color: white; border-color: var(--error); }

        table { width: 100%; margin: 15px 0; border-collapse: collapse; font-size: 0.9rem; }
        th, td { border-bottom: 1px solid #eee; padding: 10px; text-align: left; }
        
        .btn-action {
            background: var(--dinamo-blue); color: white; padding: 15px;
            border: none; border-radius: 12px; font-weight: bold; width: 100%; cursor: pointer; font-size: 1.1rem;
        }

        input[type="text"] {
            width: 100%; padding: 15px; margin: 15px 0;
            border-radius: 10px; border: 2px solid #ddd;
            box-sizing: border-box; font-size: 1rem;
        }
    </style>
</head>
<body>

    <div id="splash-screen">
        <div class="neon-wrapper">
            <div class="neon-line"></div>
            <img src="splash_logo.png" alt="Dinamo Logo" id="splash-img">
        </div>
        <h1 style="color: white; font-size: 1.5rem; margin-top: 40px; letter-spacing: 3px;">DINAMO ZAGREB</h1>
    </div>

    <div id="start-screen" class="container">
        <h2>Mamic Quiz</h2>
        <p>Bist du ein Kroatisch-Genie?</p>
        <h3>Top 3 Bestenliste</h3>
        <table>
            <thead><tr><th>Platz</th><th>Name</th><th>Gesamtzeit</th></tr></thead>
            <tbody id="start-leaderboard-body"></tbody>
        </table>
        <button class="btn-action" onclick="startGame()">Starte das Spiel</button>
    </div>

    <div id="quiz-container" class="container">
        <div class="timer-box">Zeit: <span id="timer">0:00</span></div>
        <div id="progress">Frage 1 / 20</div>
        <div class="question-box" id="question-text"></div>
        <div id="options-container"></div>
    </div>

    <div id="result-screen" class="container">
        <h2 id="rank-display">Ergebnis</h2>
        <p id="stats-summary" style="background: #f8f8f8; padding: 15px; border-radius: 10px; font-size: 0.9rem;"></p>
        <div id="name-input-section">
            <input type="text" id="user-name" placeholder="Dein Name" maxlength="15">
            <button class="btn-action" onclick="saveScore()">Speichern & Beenden</button>
        </div>
        <button class="btn-action" style="margin-top: 15px; background: #555;" onclick="location.reload()">Neustart</button>
    </div>

    <script>
        const quizData = [
            { q: "Pa jesmo li mi Corleoneovi?!", a: "Sind wir etwa die Corleones?!", w1: "Bin ich etwa Don Corleone?", w2: "Haben wir die Familie Corleoni im Kopf?" },
            { q: "Reci mi molim te gdje ste mi se ispričali.", a: "Sag mir bitte, wo ihr euch bei mir entschuldigt habt.", w1: "Sag mir bitte, wo sich die Entschuldigung versteckt.", w2: "Zeige mir den Ort, an dem das Bedauern wohnt." },
            { q: "Ne primam ga na bulju, i ne volim one koji ga primaju u bulju.", a: "Ich nehme ihn nicht als Gast auf und ich mag diejenigen nicht, die ihn als Gast aufnehmen.", w1: "Ich lade ihn nicht ins Sitzkissen der Götter.", w2: "Ich misstraue Menschen, die Argumente nutzen." },
            { q: "Mi smo dio civilizirane velike Europe, velike scene.", a: "Wir sind Teil des zivilisierten Gross-Europas, der grossen Bühne.", w1: "Europa ist gross, weil der Vorhang der Nacht fällt.", w2: "Wir sind Statisten im Opernhaus der Welt." },
            { q: "Kad radi Modrić?", a: "Wann arbeitet Modrić?", w1: "Wann arbeitet Modric an sich selbst?", w2: "Zu welcher Uhrzeit wird Modric müde?" },
            { q: "Jebem vam mater svima!", a: "Ich ficke euch allen die Mutter!", w1: "Die Mutter aller Theorien applaudiert euch.", w2: "Ich umarme eure genealogische Mutter." },
            { q: "Govna jedna, svi ste vi govna!", a: "Ihr seid allesamt Scheisse, nichts als Scheisse!", w1: "Ihr seid die Null, die den Abfall denkt.", w2: "Die Masse produziert sich selbst als Kot." },
            { q: "Serem vam se u usta!", a: "Ich scheisse euch ins Maul!", w1: "Ich rezitiere aus meinem Mund ein Gedicht.", w2: "Der Mund wird zum Parlament der Mythen." },
            { q: "Jebat ću vam mater do kraja života!", a: "Ich werde euch bis ans Lebensende die Mutter ficken!", w1: "Ich diskutiere eure Biografie bis zur Rente.", w2: "Die Ewigkeit heiratet den Stammbaum." },
            { q: "Smradovi jedni, pička vam materina!", a: "Ihr Stinker, verfickte Hurensöhne!", w1: "Ihr seid olfaktorische Fussnoten der Natur.", w2: "Der Geruch denkt zuerst, dann kommt das Wort." },
            { q: "Ko ste vi da mene sudite, jebem vam sve po spisku!", a: "Wer seid ihr, dass ihr über mich richtet? Ich ficke euch alles, was ihr habt!", w1: "Wer seid ihr, dass ihr den Richter träumt?", w2: "Die Liste verurteilt sich selbst alphabetisch." },
            { q: "Ja sam za vas institucija, a vi ste goli kurac!", a: "Ich bin für euch eine Institution, und ihr seid ein nackter Schwanz!", w1: "Ich bin das Gebäude, ihr seid die Architekten.", w2: "Die Institution trägt keine Hosen, nur Stolz." },
            { q: "Ne možete mi ništa, jebem vam državu!", a: "Ihr könnt mir nichts, ich ficke euren Staat!", w1: "Der Staat stolpert über seine eigenen Beine.", w2: "Nationale Souveränität ist ein leeres Wort." },
            { q: "Svi ste vi obični klošari!", a: "Ihr seid allesamt gewöhnliche Penner!", w1: "Ihr seid Nomaden der Grammatik.", w2: "Das Gewöhnliche schläft unter der Brücke." },
            { q: "Mrš u pičku materinu!", a: "Verpisst euch zur Hurenmutter!", w1: "Geh zurück in die Eizelle.", w2: "Verlasse den Privatbereich über den Hinterausgang." },
            { q: "Smeće jedno novinarsko!", a: "Journalistischer Abschaum!", w1: "Die Schlagzeile recycelt den Reporter.", w2: "Der Müll schreibt Leitartikel." },
            { q: "Ja sam vas sve stvorio, govna nezahvalna!", a: "Ich habe euch alle erschaffen, undankbare Scheisskerle!", w1: "Ich habe euch im Seminar erfunden.", w2: "Der Schöpfer verlangt nach einer Oper." },
            { q: "Jebem te na klinac.", a: "Du bist mir völlig egal.", w1: "Ich hänge dich an den Nagel der Bedeutung.", w2: "Der Keil denkt dich weg." },
            { q: "Prebit ću te kao mačku.", a: "Ich werde dich verprügeln wie eine Katze.", w1: "Ich falte dich wie ein argumentatives Hemd.", w2: "Die Gewalt übt Yoga an der Logik." },
            { q: "Sveti Amsterdame, ti si plavi glupac.", a: "Heiliger Amsterdam, du bist ein blauer Idiot.", w1: "Heiliger Stadtplan, du bist blau vor Ideen.", w2: "Du passt nicht ins Stadtbild." }
        ];

        let currentIdx = 0, score = 0, errors = 0, startTime, timerInterval;
        let shuffledQuestions = [];

        function shuffle(array) { return array.sort(() => Math.random() - 0.5); }
        function formatTime(totalSeconds) {
            const m = Math.floor(totalSeconds / 60);
            const s = Math.floor(totalSeconds % 60);
            return `${m}:${s < 10 ? '0' : ''}${s}`;
        }

        setTimeout(() => {
            document.getElementById('splash-screen').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('splash-screen').style.display = 'none';
                document.getElementById('start-screen').style.display = 'block';
                renderStartLeaderboard();
            }, 500);
        }, 3000);

        function startGame() {
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('quiz-container').style.display = 'block';
            shuffledQuestions = shuffle([...quizData]);
            currentIdx = 0; score = 0; errors = 0;
            startTime = Date.now();
            timerInterval = setInterval(() => {
                document.getElementById('timer').innerText = formatTime((Date.now() - startTime) / 1000);
            }, 1000);
            showQuestion();
        }

        function showQuestion() {
            if (currentIdx >= shuffledQuestions.length) { endQuiz(); return; }
            const data = shuffledQuestions[currentIdx];
            document.getElementById('progress').innerText = `Frage ${currentIdx + 1} / 20`;
            document.getElementById('question-text').innerText = data.q;
            const container = document.getElementById('options-container');
            container.innerHTML = '';
            shuffle([data.a, data.w1, data.w2]).forEach(opt => {
                const b = document.createElement('button');
                b.className = 'option'; b.innerText = opt;
                b.onclick = () => {
                    const btns = document.querySelectorAll('.option');
                    btns.forEach(btn => btn.disabled = true);
                    if (opt === data.a) {
                        score++; b.classList.add('correct');
                        setTimeout(() => { currentIdx++; showQuestion(); }, 800);
                    } else {
                        errors++; b.classList.add('wrong');
                        btns.forEach(btn => { if(btn.innerText === data.a) btn.classList.add('correct'); });
                        setTimeout(() => { currentIdx++; showQuestion(); }, 1800);
                    }
                };
                container.appendChild(b);
            });
        }

        function endQuiz() {
            clearInterval(timerInterval);
            const rawTime = (Date.now() - startTime) / 1000;
            const penalty = errors * 15;
            const total = rawTime + penalty;
            window.sessionResults = { rawTime, errors, total };
            document.getElementById('quiz-container').style.display = 'none';
            document.getElementById('result-screen').style.display = 'block';
            document.getElementById('rank-display').innerText = score === 20 ? "Kroatisch-Genie" : (score >= 12 ? "Ordentlicher Klošar" : "Du bist eine Null");
            document.getElementById('stats-summary').innerText = `Zeit: ${formatTime(rawTime)} | Fehler: ${errors} (+${penalty}s) | Gesamt: ${formatTime(total)}`;
        }

        function saveScore() {
            const name = document.getElementById('user-name').value || "Anonym";
            let board = JSON.parse(localStorage.getItem('mamic_top5')) || [];
            board.push({ name, ...window.sessionResults });
            board.sort((a, b) => a.total - b.total);
            localStorage.setItem('mamic_top5', JSON.stringify(board.slice(0, 5)));
            location.reload();
        }

        function renderStartLeaderboard() {
            const board = JSON.parse(localStorage.getItem('mamic_top5')) || [];
            const top3 = board.slice(0, 3);
            document.getElementById('start-leaderboard-body').innerHTML = top3.length > 0 
                ? top3.map((e, i) => `<tr><td>${i+1}</td><td>${e.name}</td><td>${formatTime(e.total)}</td></tr>`).join('')
                : '<tr><td colspan="3">Noch keine Einträge</td></tr>';
        }

        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js').catch(err => console.log(err));
            });
        }
    </script>
</body>
</html>
